import{_ as z,r as u,g as j,o as F,a as q,c as m,b as t,h as E,t as n,i as f,n as _,d as r,v as c,F as O,j as J,w as G,S as i,f as b}from"./index-DK9EypC2.js";const H={class:"contenido-principal"},X={class:"container mt-4"},Y={class:"encabezado-dashboard d-flex flex-wrap justify-content-between align-items-center p-3 mb-4"},K={class:"reloj text-end"},Q={class:"m-0"},R={class:"m-0"},W={class:"card tarjeta-kpi p-4 mb-4"},Z={class:"mb-3 d-flex align-items-center"},tt={class:"row align-items-center"},ot={class:"col-md-4 mb-2"},et={class:"btn-group",role:"group"},st={class:"col-md-8 mb-2 d-flex align-items-center justify-content-end"},lt={class:"input-group me-2"},at={class:"modal fade",id:"modalAgregarCliente",tabindex:"-1","aria-labelledby":"modalAgregarClienteLabel","aria-hidden":"true"},nt={class:"modal-dialog"},it={class:"modal-content"},rt={class:"modal-body"},ct={class:"row"},ut={class:"col-md-12 mb-3"},dt={class:"col-md-6 mb-3"},mt={class:"col-md-6 mb-3"},bt={class:"col-md-6 mb-3"},vt={class:"card tarjeta-tabla p-4"},pt={class:"tabla-scroll"},ft={class:"table table-hover tabla-clientes mb-0"},kt={class:"td-acciones"},gt={class:"acciones-btns d-flex gap-1 justify-content-center"},yt=["onClick"],wt=["onClick"],Ct={key:0},ht={key:0,class:"card tarjeta-tabla p-4 mb-4"},_t={class:"row"},xt={class:"col-md-6 mb-2"},At={class:"col-md-6 mb-2"},Mt={class:"col-md-6 mb-2"},St={class:"col-md-6 mb-2"},Nt={class:"text-end mt-3"},jt={key:1,class:"row"},Et={class:"col-md-6 mb-2"},Pt={class:"col-md-6 mb-2"},$t={class:"col-md-6 mb-2"},Bt={class:"col-md-6 mb-2"},Tt={__name:"Productos",setup(Vt){const l=u(null),k=u(!1);function P(s){l.value={...s},k.value=!0}async function $(){if(!l.value.nombre||l.value.costo===""||l.value.costo===null||l.value.stockMinimo===""||l.value.stockMinimo===null||l.value.stockActual===""||l.value.stockActual===null){await i.fire({icon:"warning",title:"Campos incompletos",text:"Por favor completa todos los campos."});return}try{const s={nombre:l.value.nombre,precio:l.value.costo,stock_minimo:l.value.stockMinimo,stock_actual:l.value.stockActual},o=await fetch(`http://localhost:8080/backend/public/api/gym/productos/${l.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),e=await o.json();if(!o.ok)throw new Error(e.error||"No se pudo actualizar el producto");await i.fire({icon:"success",title:"Producto actualizado",showConfirmButton:!1,timer:1200}),k.value=!1,l.value=null,await y()}catch(s){i.fire({icon:"error",title:"Error",text:s.message||"No se pudo actualizar el producto."})}}function B(){l.value=null}function T(){const s=document.getElementById("modalAgregarCliente");s&&new window.bootstrap.Modal(s).show()}async function V(){if(!a.value.nombre||a.value.costo===""||a.value.costo===null||a.value.stockMinimo===""||a.value.stockMinimo===null||a.value.stockActual===""||a.value.stockActual===null){i.fire({icon:"warning",title:"Campos incompletos",text:"Por favor completa todos los campos."});return}try{const s={nombre:a.value.nombre,precio:a.value.costo,stock_minimo:a.value.stockMinimo,stock_actual:a.value.stockActual},o=await fetch("http://localhost:8080/backend/public/api/gym/productos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),e=await o.json();if(!o.ok)throw new Error(e.error||"No se pudo agregar el producto");i.fire({icon:"success",title:"Producto agregado",showConfirmButton:!1,timer:1200}),a.value={nombre:"",costo:"",stockMinimo:"",stockActual:""};const v=document.getElementById("modalAgregarCliente");v&&window.bootstrap.Modal.getInstance(v).hide(),await y()}catch(s){i.fire({icon:"error",title:"Error",text:s.message||"No se pudo agregar el producto."})}}const g=u(""),d=u("activos"),a=u({nombre:"",costo:"",stockMinimo:"",stockActual:""}),w=u([]);async function y(){try{await fetch("http://localhost:8080/backend/public/api/gym/actualizar-dias-restantes",{method:"GET"});const s=await fetch("http://localhost:8080/backend/public/api/gym/productos");if(!s.ok)throw new Error("No se pudo obtener la lista de productos");const o=await s.json();w.value=o.map(e=>({id:e.id_producto,nombre:e.nombre,costo:e.precio,stockMinimo:e.stock_minimo,stockActual:e.stock_actual,activo:e.activo!==void 0?!!e.activo:!0}))}catch{i.fire({icon:"error",title:"Error",text:"No se pudo cargar la lista de productos."})}}const x=j(()=>{let s=[...w.value];if(d.value==="activos"?s=s.filter(o=>o.activo):d.value==="inactivos"&&(s=s.filter(o=>!o.activo)),g.value.trim()){const o=g.value.toLowerCase();s=s.filter(e=>e.nombre.toLowerCase().includes(o)||e.id&&e.id.toString().toLowerCase().includes(o))}return s}),C=s=>d.value=s,D=()=>{};async function U(s){const o=w.value.find(p=>p.id===s);if(!o)return;o.activo;const e=o.activo?"Sí, desactivar":"Sí, activar",v=o.activo?"¿Seguro que deseas desactivar este producto?":"¿Seguro que deseas activar este producto?",L=o.activo?"warning":"question";if((await i.fire({title:v,icon:L,showCancelButton:!0,confirmButtonText:e,cancelButtonText:"Cancelar",reverseButtons:!0})).isConfirmed)try{const p=await fetch(`http://localhost:8080/backend/public/api/gym/productos/estado/${s}`,{method:"PUT"}),N=await p.json();if(!p.ok)throw new Error(N.error||"No se pudo cambiar el estado del producto");l.value&&l.value.id===s&&(l.value=null,k.value=!1),await y(),i.fire({icon:"success",title:N.mensaje||"Estado actualizado",showConfirmButton:!1,timer:1200})}catch(p){i.fire({icon:"error",title:"Error",text:p.message||"No se pudo cambiar el estado del producto."})}}const I=j(()=>{switch(d.value){case"activos":return"Productos Activos";case"inactivos":return"Productos Inactivos";case"todos":return"Todos los Productos";default:return"Productos"}}),A=u(""),M=u("");let h=null;function S(){const s=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],o=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],e=new Date;A.value=`${s[e.getDay()]}, ${e.getDate()} de ${o[e.getMonth()]} de ${e.getFullYear()}`,M.value=e.toLocaleTimeString("es-MX",{hour12:!1})}return F(()=>{S(),h=setInterval(S,1e3),y()}),q(()=>{h&&clearInterval(h)}),(s,o)=>(b(),m("div",H,[t("div",X,[t("div",Y,[o[14]||(o[14]=t("div",{class:"saludo"},[t("h4",{class:"m-0"},"Productos")],-1)),t("div",K,[t("p",Q,n(A.value),1),t("p",R,n(M.value),1)])]),t("div",W,[t("h5",Z,[o[15]||(o[15]=t("i",{class:"material-icons me-2"},"inventory_2",-1)),f(" "+n(I.value),1)]),t("div",tt,[t("div",ot,[t("div",et,[t("button",{class:_(["btn",d.value==="activos"?"btn-primary":"btn-outline-primary"]),onClick:o[0]||(o[0]=e=>C("activos"))},"Activos",2),t("button",{class:_(["btn",d.value==="inactivos"?"btn-secondary":"btn-outline-secondary"]),onClick:o[1]||(o[1]=e=>C("inactivos"))},"Inactivos",2),t("button",{class:_(["btn",d.value==="todos"?"btn-info":"btn-outline-info"]),onClick:o[2]||(o[2]=e=>C("todos"))},"Todos",2)])]),t("div",st,[t("div",lt,[r(t("input",{type:"text",class:"form-control",placeholder:"Buscar producto...","onUpdate:modelValue":o[3]||(o[3]=e=>g.value=e),onInput:D},null,544),[[c,g.value]]),t("button",{class:"btn btn-outline-secondary",onClick:o[4]||(o[4]=e=>{g.value=""})},o[16]||(o[16]=[t("i",{class:"material-icons"},"clear",-1)]))]),t("button",{class:"btn btn-success",onClick:T},o[17]||(o[17]=[t("i",{class:"material-icons me-1"},"add_box",-1)]))])])]),t("div",at,[t("div",nt,[t("div",it,[o[19]||(o[19]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"modalAgregarClienteLabel"},"Agregar nuevo producto"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cerrar"})],-1)),t("div",rt,[t("div",ct,[t("div",ut,[r(t("input",{"onUpdate:modelValue":o[5]||(o[5]=e=>a.value.nombre=e),type:"text",class:"form-control",placeholder:"Nombre del producto"},null,512),[[c,a.value.nombre]])]),t("div",dt,[r(t("input",{"onUpdate:modelValue":o[6]||(o[6]=e=>a.value.costo=e),type:"number",class:"form-control",placeholder:"Costo",min:"0",step:"0.01"},null,512),[[c,a.value.costo,void 0,{number:!0}]])]),t("div",mt,[r(t("input",{"onUpdate:modelValue":o[7]||(o[7]=e=>a.value.stockMinimo=e),type:"number",class:"form-control",placeholder:"Stock mínimo",min:"0"},null,512),[[c,a.value.stockMinimo,void 0,{number:!0}]])]),t("div",bt,[r(t("input",{"onUpdate:modelValue":o[8]||(o[8]=e=>a.value.stockActual=e),type:"number",class:"form-control",placeholder:"Stock actual",min:"0"},null,512),[[c,a.value.stockActual,void 0,{number:!0}]])])])]),t("div",{class:"modal-footer"},[o[18]||(o[18]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar",-1)),t("button",{type:"button",class:"btn btn-success",onClick:V},"Agregar Producto")])])])]),t("div",vt,[o[24]||(o[24]=t("h5",{class:"mb-3 d-flex align-items-center"},[t("i",{class:"material-icons me-2"},"table_view"),f(" Listado de productos ")],-1)),t("div",pt,[t("table",ft,[o[23]||(o[23]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Nombre"),t("th",null,"Costo"),t("th",null,"Stock mínimo"),t("th",null,"Stock actual"),t("th",null,"Acciones")])],-1)),t("tbody",null,[(b(!0),m(O,null,J(x.value,e=>(b(),m("tr",{key:e.id},[t("td",null,n(e.id),1),t("td",null,n(e.nombre),1),t("td",null,"$"+n(Number(e.costo).toFixed(2)),1),t("td",null,n(e.stockMinimo),1),t("td",null,n(e.stockActual),1),t("td",kt,[t("div",gt,[t("button",{class:"btn btn-sm btn-outline-warning",title:"Editar",onClick:v=>P(e)},o[20]||(o[20]=[t("i",{class:"material-icons"},"edit",-1)]),8,yt),t("button",{class:"btn btn-sm btn-outline-danger",title:"Eliminar",onClick:v=>U(e.id)},o[21]||(o[21]=[t("i",{class:"material-icons"},"delete",-1)]),8,wt)])])]))),128)),x.value.length===0?(b(),m("tr",Ct,o[22]||(o[22]=[t("td",{colspan:"6",class:"text-center text-muted"},"No hay productos encontrados.",-1)]))):E("",!0)])])])]),l.value?(b(),m("div",ht,[t("div",{class:"d-flex justify-content-between align-items-center mb-2"},[o[26]||(o[26]=t("h5",{class:"mb-0"},"Detalle de producto",-1)),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:B,title:"Cerrar"},o[25]||(o[25]=[t("i",{class:"material-icons"},"close",-1)]))]),k.value?(b(),m("form",{key:0,onSubmit:G($,["prevent"])},[t("div",_t,[t("div",xt,[o[27]||(o[27]=t("label",{class:"form-label"},[t("b",null,"Nombre:")],-1)),r(t("input",{"onUpdate:modelValue":o[9]||(o[9]=e=>l.value.nombre=e),type:"text",class:"form-control"},null,512),[[c,l.value.nombre]])]),t("div",At,[o[28]||(o[28]=t("label",{class:"form-label"},[t("b",null,"Costo:")],-1)),r(t("input",{"onUpdate:modelValue":o[10]||(o[10]=e=>l.value.costo=e),type:"number",class:"form-control",min:"0",step:"0.01"},null,512),[[c,l.value.costo,void 0,{number:!0}]])]),t("div",Mt,[o[29]||(o[29]=t("label",{class:"form-label"},[t("b",null,"Stock mínimo:")],-1)),r(t("input",{"onUpdate:modelValue":o[11]||(o[11]=e=>l.value.stockMinimo=e),type:"number",class:"form-control",min:"0"},null,512),[[c,l.value.stockMinimo,void 0,{number:!0}]])]),t("div",St,[o[30]||(o[30]=t("label",{class:"form-label"},[t("b",null,"Stock actual:")],-1)),r(t("input",{"onUpdate:modelValue":o[12]||(o[12]=e=>l.value.stockActual=e),type:"number",class:"form-control",min:"0"},null,512),[[c,l.value.stockActual,void 0,{number:!0}]])])]),t("div",Nt,[o[31]||(o[31]=t("button",{type:"submit",class:"btn btn-success me-2"},"Guardar cambios",-1)),t("button",{type:"button",class:"btn btn-secondary",onClick:o[13]||(o[13]=e=>k.value=!1)},"Cancelar")])],32)):(b(),m("div",jt,[t("div",Et,[o[32]||(o[32]=t("b",null,"Nombre:",-1)),f(" "+n(l.value.nombre),1)]),t("div",Pt,[o[33]||(o[33]=t("b",null,"Costo:",-1)),f(" $"+n(Number(l.value.costo).toFixed(2)),1)]),t("div",$t,[o[34]||(o[34]=t("b",null,"Stock mínimo:",-1)),f(" "+n(l.value.stockMinimo),1)]),t("div",Bt,[o[35]||(o[35]=t("b",null,"Stock actual:",-1)),f(" "+n(l.value.stockActual),1)])]))])):E("",!0)])]))}},It=z(Tt,[["__scopeId","data-v-263262bf"]]);export{It as default};
