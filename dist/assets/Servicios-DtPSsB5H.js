import{_ as L,r,g as E,o as V,a as U,c as m,b as t,h as $,t as c,i as w,n as x,d as p,v as g,F as P,j as O,w as J,S as i,f as v}from"./index-DK9EypC2.js";const q={class:"contenido-principal"},G={class:"container mt-4"},H={class:"encabezado-dashboard d-flex flex-wrap justify-content-between align-items-center p-3 mb-4"},X={class:"reloj text-end"},Y={class:"m-0"},K={class:"m-0"},Q={class:"card tarjeta-kpi p-4 mb-4"},R={class:"mb-3 d-flex align-items-center"},W={class:"row align-items-center"},Z={class:"col-md-4 mb-2"},tt={class:"btn-group",role:"group"},et={class:"col-md-8 mb-2 d-flex align-items-center justify-content-end"},ot={class:"input-group me-2"},st={class:"modal fade",id:"modalAgregarCliente",tabindex:"-1","aria-labelledby":"modalAgregarClienteLabel","aria-hidden":"true"},at={class:"modal-dialog"},it={class:"modal-content"},nt={class:"modal-body"},lt={class:"row"},rt={class:"col-md-12 mb-3"},ct={class:"col-md-12 mb-3"},dt={class:"card tarjeta-tabla p-4"},ut={class:"tabla-scroll"},mt={class:"table table-hover tabla-clientes mb-0"},vt={class:"td-acciones"},bt={class:"acciones-btns d-flex gap-1 justify-content-center"},ft=["onClick"],pt=["onClick"],gt={key:0},yt={key:0,class:"card tarjeta-tabla p-4 mb-4"},wt={class:"row"},Ct={class:"col-md-6 mb-2"},ht={class:"col-md-6 mb-2"},xt={class:"text-end mt-3"},_t={key:1,class:"row"},kt={class:"col-md-6 mb-2"},St={class:"col-md-6 mb-2"},Nt={__name:"Servicios",setup(jt){const a=r(null),b=r(!1);function B(s){a.value={...s},b.value=!0}async function T(){if(!a.value.nombre||a.value.costo===""||a.value.costo===null){await i.fire({icon:"warning",title:"Campos incompletos",text:"Por favor completa todos los campos."});return}try{const s=await fetch(`http://localhost:8080/backend/public/api/gym/servicios/${a.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:a.value.nombre,costo:a.value.costo,activo:!0})}),e=await s.json();if(s.ok){const o=u.value.findIndex(l=>l.id===a.value.id);o!==-1&&(u.value[o]={...u.value[o],nombre:a.value.nombre,costo:a.value.costo}),await i.fire({icon:"success",title:"Servicio actualizado",showConfirmButton:!1,timer:1200}),b.value=!1,a.value=null}else await i.fire({icon:"error",title:"Error",text:e.error||"No se pudo actualizar el servicio."})}catch{await i.fire({icon:"error",title:"Error de red",text:"No se pudo conectar al servidor."})}}function D(){a.value=null}function A(){const s=document.getElementById("modalAgregarCliente");s&&new window.bootstrap.Modal(s).show()}async function I(){if(!n.value.nombre||n.value.costo===""||n.value.costo===null){i.fire({icon:"warning",title:"Campos incompletos",text:"Por favor completa todos los campos."});return}try{const s={nombre:n.value.nombre,costo:n.value.costo},e=await fetch("http://localhost:8080/backend/public/api/gym/servicios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),o=await e.json();if(!e.ok)throw new Error(o.error||"No se pudo agregar el servicio");i.fire({icon:"success",title:"Servicio agregado",showConfirmButton:!1,timer:1200}),n.value={nombre:"",costo:""};const l=document.getElementById("modalAgregarCliente");l&&window.bootstrap.Modal.getInstance(l).hide(),await _()}catch(s){i.fire({icon:"error",title:"Error",text:s.message||"No se pudo agregar el servicio."})}}const f=r(""),d=r("activos"),n=r({nombre:"",costo:""}),u=r([]);async function _(){try{await fetch("http://localhost:8080/backend/public/api/gym/actualizar-dias-restantes",{method:"GET"});const s=await fetch("http://localhost:8080/backend/public/api/gym/servicios");if(!s.ok)throw new Error("No se pudo obtener la lista de servicios");const e=await s.json();u.value=e.map(o=>({id:o.id_servicio||o.id,nombre:o.nombre,costo:o.costo,activo:o.activo!==void 0?!!o.activo:!0}))}catch{i.fire({icon:"error",title:"Error",text:"No se pudo cargar la lista de servicios."})}}const k=E(()=>{let s=[...u.value];if(d.value==="activos"?s=s.filter(e=>e.activo):d.value==="inactivos"&&(s=s.filter(e=>!e.activo)),f.value.trim()){const e=f.value.toLowerCase();s=s.filter(o=>o.nombre.toLowerCase().includes(e))}return s}),C=s=>d.value=s,M=()=>{};function z(s){i.fire({title:"¿Seguro que deseas desactivar este cliente?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, desactivar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(async e=>{if(e.isConfirmed)try{const o=await fetch(`http://localhost:8080/backend/public/api/gym/servicios/estado/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"}}),l=await o.json();o.ok?(u.value=u.value.map(y=>y.id===s?{...y,activo:!y.activo}:y),a.value&&a.value.id===s&&(a.value=null,b.value=!1),i.fire({icon:"success",title:l.mensaje||"Estado actualizado",showConfirmButton:!1,timer:1200})):i.fire({icon:"error",title:"Error",text:l.error||"No se pudo actualizar el estado del cliente"})}catch{i.fire({icon:"error",title:"Error de red",text:"No se pudo conectar al servidor."})}})}const F=E(()=>{switch(d.value){case"activos":return"Servicios Activos";case"inactivos":return"Servicios Inactivos";case"todos":return"Todos los Servicios";default:return"Servicios"}}),S=r(""),N=r("");let h=null;function j(){const s=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],e=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],o=new Date;S.value=`${s[o.getDay()]}, ${o.getDate()} de ${e[o.getMonth()]} de ${o.getFullYear()}`,N.value=o.toLocaleTimeString("es-MX",{hour12:!1})}return V(()=>{j(),h=setInterval(j,1e3),_()}),U(()=>{h&&clearInterval(h)}),(s,e)=>(v(),m("div",q,[t("div",G,[t("div",H,[e[10]||(e[10]=t("div",{class:"saludo"},[t("h4",{class:"m-0"},"Servicios")],-1)),t("div",X,[t("p",Y,c(S.value),1),t("p",K,c(N.value),1)])]),t("div",Q,[t("h5",R,[e[11]||(e[11]=t("i",{class:"material-icons me-2"},"inventory_2",-1)),w(" "+c(F.value),1)]),t("div",W,[t("div",Z,[t("div",tt,[t("button",{class:x(["btn",d.value==="activos"?"btn-primary":"btn-outline-primary"]),onClick:e[0]||(e[0]=o=>C("activos"))},"Activos",2),t("button",{class:x(["btn",d.value==="inactivos"?"btn-secondary":"btn-outline-secondary"]),onClick:e[1]||(e[1]=o=>C("inactivos"))},"Inactivos",2),t("button",{class:x(["btn",d.value==="todos"?"btn-info":"btn-outline-info"]),onClick:e[2]||(e[2]=o=>C("todos"))},"Todos",2)])]),t("div",et,[t("div",ot,[p(t("input",{type:"text",class:"form-control",placeholder:"Buscar servicio...","onUpdate:modelValue":e[3]||(e[3]=o=>f.value=o),onInput:M},null,544),[[g,f.value]]),t("button",{class:"btn btn-outline-secondary",onClick:e[4]||(e[4]=o=>{f.value=""})},e[12]||(e[12]=[t("i",{class:"material-icons"},"clear",-1)]))]),t("button",{class:"btn btn-success",onClick:A},e[13]||(e[13]=[t("i",{class:"material-icons me-1"},"add_box",-1)]))])])]),t("div",st,[t("div",at,[t("div",it,[e[15]||(e[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"modalAgregarClienteLabel"},"Agregar nuevo servicio"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Cerrar"})],-1)),t("div",nt,[t("div",lt,[t("div",rt,[p(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>n.value.nombre=o),type:"text",class:"form-control",placeholder:"Nombre del servicio"},null,512),[[g,n.value.nombre]])]),t("div",ct,[p(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>n.value.costo=o),type:"number",class:"form-control",placeholder:"Costo",min:"0",step:"0.01"},null,512),[[g,n.value.costo,void 0,{number:!0}]])])])]),t("div",{class:"modal-footer"},[e[14]||(e[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar",-1)),t("button",{type:"button",class:"btn btn-success",onClick:I},"Agregar Servicio")])])])]),t("div",dt,[e[20]||(e[20]=t("h5",{class:"mb-3 d-flex align-items-center"},[t("i",{class:"material-icons me-2"},"table_view"),w(" Listado de productos ")],-1)),t("div",ut,[t("table",mt,[e[19]||(e[19]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Nombre"),t("th",null,"Costo"),t("th",null,"Acciones")])],-1)),t("tbody",null,[(v(!0),m(P,null,O(k.value,o=>(v(),m("tr",{key:o.id},[t("td",null,c(o.id),1),t("td",null,c(o.nombre),1),t("td",null,"$"+c(Number(o.costo).toFixed(2)),1),t("td",vt,[t("div",bt,[t("button",{class:"btn btn-sm btn-outline-warning",title:"Editar",onClick:l=>B(o)},e[16]||(e[16]=[t("i",{class:"material-icons"},"edit",-1)]),8,ft),t("button",{class:"btn btn-sm btn-outline-danger",title:"Eliminar",onClick:l=>z(o.id)},e[17]||(e[17]=[t("i",{class:"material-icons"},"delete",-1)]),8,pt)])])]))),128)),k.value.length===0?(v(),m("tr",gt,e[18]||(e[18]=[t("td",{colspan:"4",class:"text-center text-muted"},"No hay servicios encontrados.",-1)]))):$("",!0)])])])]),a.value?(v(),m("div",yt,[t("div",{class:"d-flex justify-content-between align-items-center mb-2"},[e[22]||(e[22]=t("h5",{class:"mb-0"},"Detalle de servicio",-1)),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:D,title:"Cerrar"},e[21]||(e[21]=[t("i",{class:"material-icons"},"close",-1)]))]),b.value?(v(),m("form",{key:0,onSubmit:J(T,["prevent"])},[t("div",wt,[t("div",Ct,[e[23]||(e[23]=t("label",{class:"form-label"},[t("b",null,"Nombre:")],-1)),p(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>a.value.nombre=o),type:"text",class:"form-control"},null,512),[[g,a.value.nombre]])]),t("div",ht,[e[24]||(e[24]=t("label",{class:"form-label"},[t("b",null,"Costo:")],-1)),p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>a.value.costo=o),type:"number",class:"form-control",min:"0",step:"0.01"},null,512),[[g,a.value.costo,void 0,{number:!0}]])])]),t("div",xt,[e[25]||(e[25]=t("button",{type:"submit",class:"btn btn-success me-2"},"Guardar cambios",-1)),t("button",{type:"button",class:"btn btn-secondary",onClick:e[9]||(e[9]=o=>b.value=!1)},"Cancelar")])],32)):(v(),m("div",_t,[t("div",kt,[e[26]||(e[26]=t("b",null,"Nombre:",-1)),w(" "+c(a.value.nombre),1)]),t("div",St,[e[27]||(e[27]=t("b",null,"Costo:",-1)),w(" $"+c(Number(a.value.costo).toFixed(2)),1)])]))])):$("",!0)])]))}},$t=L(Nt,[["__scopeId","data-v-2df239f7"]]);export{$t as default};
